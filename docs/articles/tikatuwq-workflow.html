<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tikatuwq: From raw water quality data to CONAMA report • tikatuwq</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tikatuwq: From raw water quality data to CONAMA report">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tikatuwq</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tikatuwq/tikatuwq" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>tikatuwq: From raw water quality data to CONAMA report</h1>
                        <h4 data-toc-skip class="author">tikatuwq
developers</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tikatuwq/tikatuwq/blob/HEAD/vignettes/tikatuwq-workflow.Rmd" class="external-link"><code>vignettes/tikatuwq-workflow.Rmd</code></a></small>
      <div class="d-none name"><code>tikatuwq-workflow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The tikatuwq package provides a reproducible workflow for Brazilian
water quality assessment. It implements common indices such as the
IQA/WQI and Carlson or Lamparelli trophic state indices, together with
CONAMA 357/2005 compliance checks, plotting helpers and basic reporting
tools.</p>
<p>The package now includes a real dataset containing water quality
measurements collected by INEMA (Environmental Agency of Bahia) during
monitoring campaigns between 2021 and 2024 in the Rio Buranhem
watershed, Porto Seguro, Bahia, Brazil. This dataset is included for
demonstration and reproducibility purposes, closely following the
analytical workflow presented in this vignette. All variable names
correspond to real monitoring attributes.</p>
<p>In this vignette we demonstrate a typical pipeline: reading a raw CSV
file, handling censored values (ND / &lt;LD / &lt;LOQ), cleaning units,
computing indices, checking legal compliance and generating simple plots
and a textual report. The goal is to show an end-to-end example that
users can adapt to their own datasets.</p>
<p>This workflow is particularly useful for environmental monitoring
programs that need to comply with Brazilian regulations and produce
standardized reports for regulatory agencies.</p>
</div>
<div class="section level2">
<h2 id="package-overview-and-included-real-data">Package overview and included real data<a class="anchor" aria-label="anchor" href="#package-overview-and-included-real-data"></a>
</h2>
<p>We start by loading the package and examining the included real
dataset from Buranhem River/INEMA:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tikatuwq/tikatuwq" class="external-link">tikatuwq</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"wq_demo"</span>, package <span class="op">=</span> <span class="st">"tikatuwq"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">wq_demo</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [20 × 14] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ rio        : chr [1:20] "BURANHEM" "BURANHEM" "BURANHEM" "BURANHEM" ...</span></span>
<span><span class="co">#&gt;  $ ponto      : chr [1:20] "FBS-BRH-250" "FBS-BRH-250" "FBS-BRH-250" "FBS-BRH-250" ...</span></span>
<span><span class="co">#&gt;  $ data       : Date[1:20], format: "2020-03-03" "2022-03-10" ...</span></span>
<span><span class="co">#&gt;  $ ph         : num [1:20] 6.52 6.97 8.19 7.55 7.8 6.39 5.87 8.53 7.08 8.1 ...</span></span>
<span><span class="co">#&gt;  $ od         : num [1:20] 6.03 6.52 6.13 5.96 7.58 6.7 6.51 6.19 7.51 7.3 ...</span></span>
<span><span class="co">#&gt;  $ turbidez   : num [1:20] 63.5 18.3 9 112 5.8 11.4 68.6 10.4 141 5.4 ...</span></span>
<span><span class="co">#&gt;  $ dbo        : num [1:20] 3 3 4 3 3 7 4 4 3 3 ...</span></span>
<span><span class="co">#&gt;  $ coliformes : num [1:20] 7.9 9.2 7.9 1.7 2.3 1.3 5.4 2.3 1.6 7.9 ...</span></span>
<span><span class="co">#&gt;  $ p_total    : num [1:20] 0.02 0.04 0.02 0.08 0.02 0.03 0.03 0.02 0.1 0.03 ...</span></span>
<span><span class="co">#&gt;  $ nt_total   : num [1:20] 1 1 1 1.9 1 1 1 1 1.8 1 ...</span></span>
<span><span class="co">#&gt;  $ temperatura: num [1:20] 30.1 26.5 27.4 30.1 29.1 28.7 25.8 25.5 26.7 28.6 ...</span></span>
<span><span class="co">#&gt;  $ tds        : num [1:20] 119 51 50 50 50 60 68 52 50 52 ...</span></span>
<span><span class="co">#&gt;  $ lat        : num [1:20] -16.4 -16.4 -16.4 -16.4 -16.4 ...</span></span>
<span><span class="co">#&gt;  $ lon        : num [1:20] -39.6 -39.6 -39.6 -39.6 -39.6 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">wq_demo</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 14</span></span></span>
<span><span class="co">#&gt;   rio    ponto data          ph    od turbidez   dbo coliformes p_total nt_total</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> BURAN… FBS-… 2020-03-03  6.52  6.03     63.5     3        7.9    0.02      1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> BURAN… FBS-… 2022-03-10  6.97  6.52     18.3     3        9.2    0.04      1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BURAN… FBS-… 2023-05-24  8.19  6.13      9       4        7.9    0.02      1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> BURAN… FBS-… 2024-02-20  7.55  5.96    112       3        1.7    0.08      1.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> BURAN… FBS-… 2024-09-04  7.8   7.58      5.8     3        2.3    0.02      1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> BURAN… FBS-… 2020-03-04  6.39  6.7      11.4     7        1.3    0.03      1  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: temperatura &lt;dbl&gt;, tds &lt;dbl&gt;, lat &lt;dbl&gt;, lon &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The <code>wq_demo</code> dataset contains 20 rows and 14 columns,
including: - <code>rio</code>: river name (BURANHEM) -
<code>ponto</code>: monitoring point identifier - <code>data</code>:
sampling date - <code>ph</code>, <code>od</code>, <code>turbidez</code>,
<code>dbo</code>: water quality parameters - <code>coliformes</code>:
fecal coliforms - <code>p_total</code>, <code>nt_total</code>:
phosphorus and nitrogen - <code>temperatura</code>, <code>tds</code>:
temperature and total dissolved solids - <code>lat</code>,
<code>lon</code>: coordinates</p>
</div>
<div class="section level2">
<h2 id="reading-and-validating-water-quality-data">Reading and validating water quality data<a class="anchor" aria-label="anchor" href="#reading-and-validating-water-quality-data"></a>
</h2>
<p>The first step in any analysis is reading the raw data. The
<code><a href="../reference/read_wq.html">read_wq()</a></code> function handles common CSV formats with robust
parsing:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: reading from a CSV file</span></span>
<span><span class="co"># df &lt;- read_wq("path/to/your/data.csv")</span></span></code></pre></div>
<p>For this vignette, we use the demo dataset. In practice,
<code><a href="../reference/read_wq.html">read_wq()</a></code> handles: - Comma or semicolon delimiters - Comma
or dot decimal separators - Unit suffixes in numeric columns (e.g.,
“0.04 mg/L”) - Date formats (YYYY-MM-DD or DD/MM/YYYY) - Coordinate
normalization if needed</p>
<p>Next, we validate that required columns are present:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">wq_demo</span></span>
<span></span>
<span><span class="co"># Validate required columns</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate_wq.html">validate_wq</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [20 × 14] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ rio        : chr [1:20] "BURANHEM" "BURANHEM" "BURANHEM" "BURANHEM" ...</span></span>
<span><span class="co">#&gt;  $ ponto      : chr [1:20] "FBS-BRH-250" "FBS-BRH-250" "FBS-BRH-250" "FBS-BRH-250" ...</span></span>
<span><span class="co">#&gt;  $ data       : Date[1:20], format: "2020-03-03" "2022-03-10" ...</span></span>
<span><span class="co">#&gt;  $ ph         : num [1:20] 6.52 6.97 8.19 7.55 7.8 6.39 5.87 8.53 7.08 8.1 ...</span></span>
<span><span class="co">#&gt;  $ od         : num [1:20] 6.03 6.52 6.13 5.96 7.58 6.7 6.51 6.19 7.51 7.3 ...</span></span>
<span><span class="co">#&gt;  $ turbidez   : num [1:20] 63.5 18.3 9 112 5.8 11.4 68.6 10.4 141 5.4 ...</span></span>
<span><span class="co">#&gt;  $ dbo        : num [1:20] 3 3 4 3 3 7 4 4 3 3 ...</span></span>
<span><span class="co">#&gt;  $ coliformes : num [1:20] 7.9 9.2 7.9 1.7 2.3 1.3 5.4 2.3 1.6 7.9 ...</span></span>
<span><span class="co">#&gt;  $ p_total    : num [1:20] 0.02 0.04 0.02 0.08 0.02 0.03 0.03 0.02 0.1 0.03 ...</span></span>
<span><span class="co">#&gt;  $ nt_total   : num [1:20] 1 1 1 1.9 1 1 1 1 1.8 1 ...</span></span>
<span><span class="co">#&gt;  $ temperatura: num [1:20] 30.1 26.5 27.4 30.1 29.1 28.7 25.8 25.5 26.7 28.6 ...</span></span>
<span><span class="co">#&gt;  $ tds        : num [1:20] 119 51 50 50 50 60 68 52 50 52 ...</span></span>
<span><span class="co">#&gt;  $ lat        : num [1:20] -16.4 -16.4 -16.4 -16.4 -16.4 ...</span></span>
<span><span class="co">#&gt;  $ lon        : num [1:20] -39.6 -39.6 -39.6 -39.6 -39.6 ...</span></span></code></pre></div>
<p>The <code><a href="../reference/validate_wq.html">validate_wq()</a></code> function ensures that the minimal set
of columns required for IQA calculation and CONAMA checks is
present.</p>
</div>
<div class="section level2">
<h2 id="handling-censored-values-nd-ld-loq">Handling censored values (ND / &lt;LD / &lt;LOQ)<a class="anchor" aria-label="anchor" href="#handling-censored-values-nd-ld-loq"></a>
</h2>
<p>Water quality data often contains censored values, where
concentrations are below the detection limit. The tikatuwq package
provides explicit handling for these cases.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with censored values</span></span>
<span><span class="co"># If your CSV contains values like "&lt;0.01", "&lt;LD", or "ND", read_wq() handles them</span></span>
<span><span class="co"># with the nd_policy parameter:</span></span>
<span></span>
<span><span class="co"># df_with_nd &lt;- read_wq("data.csv", nd_policy = "ld2")</span></span></code></pre></div>
<p>The <code>nd_policy</code> parameter accepts four options: -
<code>"ld2"</code> (default): uses half of the detection limit -
<code>"ld"</code>: uses the detection limit value - <code>"zero"</code>:
replaces with 0 - <code>"na"</code>: replaces with NA</p>
<p>For this demo, the dataset does not contain censored values, but in
real data you would see them parsed automatically when using
<code><a href="../reference/read_wq.html">read_wq()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="cleaning-units-and-basic-qaqc">Cleaning units and basic QA/QC<a class="anchor" aria-label="anchor" href="#cleaning-units-and-basic-qaqc"></a>
</h2>
<p>The <code><a href="../reference/clean_units.html">clean_units()</a></code> function validates parameter ranges
and can convert units if specified:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clean and validate units</span></span>
<span><span class="va">df_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_units.html">clean_units</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If units need conversion (e.g., ug/L to mg/L for phosphorus):</span></span>
<span><span class="co"># df_clean &lt;- clean_units(df, units_map = list(p_total = "ug/L"))</span></span></code></pre></div>
<p>The function: - Validates typical ranges (pH, OD, turbidity, etc.) -
Warns about outliers - Converts units when <code>units_map</code> is
provided</p>
</div>
<div class="section level2">
<h2 id="computing-indices-iqa-and-trophic-state">Computing indices (IQA and trophic state)<a class="anchor" aria-label="anchor" href="#computing-indices-iqa-and-trophic-state"></a>
</h2>
<div class="section level3">
<h3 id="water-quality-index-iqa">Water Quality Index (IQA)<a class="anchor" aria-label="anchor" href="#water-quality-index-iqa"></a>
</h3>
<p>The IQA combines multiple parameters into a single score (0-100):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute IQA</span></span>
<span><span class="va">df_iqa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/iqa.html">iqa</a></span><span class="op">(</span><span class="va">df_clean</span>, na_rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_iqa</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ponto"</span>, <span class="st">"IQA"</span>, <span class="st">"IQA_status"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   ponto         IQA IQA_status</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FBS-BRH-250  89.8 Boa       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> FBS-BRH-250  93.1 Otima     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> FBS-BRH-250  92.2 Otima     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> FBS-BRH-250  87.6 Boa       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> FBS-BRH-250  95.7 Otima     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> FBS-BRH-300  89.3 Boa</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df_iqa</span><span class="op">$</span><span class="va">IQA</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   85.35   89.18   91.91   91.35   93.88   95.72</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_iqa</span><span class="op">$</span><span class="va">IQA_status</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Muito ruim       Ruim    Regular        Boa      Otima </span></span>
<span><span class="co">#&gt;          0          0          0          8         12</span></span></code></pre></div>
<p>The <code>IQA_status</code> column provides qualitative
classification (Very Poor, Poor, Fair, Good, Excellent).</p>
</div>
<div class="section level3">
<h3 id="trophic-state-index-iet">Trophic State Index (IET)<a class="anchor" aria-label="anchor" href="#trophic-state-index-iet"></a>
</h3>
<p>For lakes and reservoirs, trophic state indices indicate
eutrophication level:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Carlson IET (requires secchi depth, chlorophyll, total phosphorus)</span></span>
<span><span class="co"># df_iet &lt;- iet_carlson(df, .keep_ids = TRUE)</span></span>
<span></span>
<span><span class="co"># Lamparelli IET</span></span>
<span><span class="co"># df_iet &lt;- iet_lamparelli(df, .keep_ids = TRUE)</span></span></code></pre></div>
<p>Note: IET functions require specific parameters (secchi depth,
chlorophyll) that are not in <code>wq_demo</code>. Use them when
analyzing lentic (still water) systems.</p>
</div>
</div>
<div class="section level2">
<h2 id="checking-conama-3572005-compliance">Checking CONAMA 357/2005 compliance<a class="anchor" aria-label="anchor" href="#checking-conama-3572005-compliance"></a>
</h2>
<p>The CONAMA Resolution 357/2005 establishes limits for water quality
parameters according to water use classes (1-4 and special). The package
provides several functions to check compliance:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check compliance for class 2 (default)</span></span>
<span><span class="va">df_conama</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conama_check.html">conama_check</a></span><span class="op">(</span><span class="va">df_iqa</span>, classe <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View compliance columns (one per parameter)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_conama</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_ok$"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_conama</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   ph_ok od_ok turbidez_ok dbo_ok coliformes_ok p_total_ok</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TRUE  TRUE  TRUE        TRUE   TRUE          TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE  TRUE  TRUE        TRUE   TRUE          TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> TRUE  TRUE  TRUE        TRUE   TRUE          TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> TRUE  TRUE  FALSE       TRUE   TRUE          FALSE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> TRUE  TRUE  TRUE        TRUE   TRUE          TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> TRUE  TRUE  TRUE        FALSE  TRUE          TRUE</span></span></code></pre></div>
<div class="section level3">
<h3 id="summary-and-reports">Summary and reports<a class="anchor" aria-label="anchor" href="#summary-and-reports"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Long-format summary</span></span>
<span><span class="va">summary_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conama_summary.html">conama_summary</a></span><span class="op">(</span><span class="va">df_conama</span>, classe <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summary_long</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   parametro valor lim_min lim_max status ok    delta</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ph         6.52       6       9 ok     TRUE      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ph         6.97       6       9 ok     TRUE      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ph         8.19       6       9 ok     TRUE      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ph         7.55       6       9 ok     TRUE      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ph         7.8        6       9 ok     TRUE      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> ph         6.39       6       9 ok     TRUE      0</span></span>
<span></span>
<span><span class="co"># Report table (violations only, formatted)</span></span>
<span><span class="va">report_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conama_report.html">conama_report</a></span><span class="op">(</span><span class="va">df_conama</span>, classe <span class="op">=</span> <span class="st">"2"</span>, only_violations <span class="op">=</span> <span class="cn">TRUE</span>, pretty <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">report_tab</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 6</span></span></span>
<span><span class="co">#&gt;    parametro valor lim_min lim_max status           delta </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> dbo       7     <span style="color: #BB0000;">NA</span>      5       acima_do_maximo  +2    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> dbo       6     <span style="color: #BB0000;">NA</span>      5       acima_do_maximo  +1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> od        4,9   5       <span style="color: #BB0000;">NA</span>      abaixo_do_minimo -0,09 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> p_total   0,08  <span style="color: #BB0000;">NA</span>      0,05    acima_do_maximo  +0,03 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> p_total   0,1   <span style="color: #BB0000;">NA</span>      0,05    acima_do_maximo  +0,05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> p_total   0,1   <span style="color: #BB0000;">NA</span>      0,05    acima_do_maximo  +0,05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> p_total   0,06  <span style="color: #BB0000;">NA</span>      0,05    acima_do_maximo  +0,010</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> p_total   0,09  <span style="color: #BB0000;">NA</span>      0,05    acima_do_maximo  +0,04 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ph        5,9   6       9       abaixo_do_minimo -0,13 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> turbidez  112   <span style="color: #BB0000;">NA</span>      100     acima_do_maximo  +12   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> turbidez  141   <span style="color: #BB0000;">NA</span>      100     acima_do_maximo  +41</span></span>
<span></span>
<span><span class="co"># Textual summary</span></span>
<span><span class="va">summary_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conama_text.html">conama_text</a></span><span class="op">(</span><span class="va">df_conama</span>, classe <span class="op">=</span> <span class="st">"2"</span>, only_violations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">summary_text</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Conformidade CONAMA classe 2:</span></span>
<span><span class="co">#&gt; - dbo: 2/20 violacoes (ex.: valor=7 (lim_max=5 delta=+2))</span></span>
<span><span class="co">#&gt; - od: 1/20 violacoes (ex.: valor=4,9 (lim_min=5 delta=-0,09))</span></span>
<span><span class="co">#&gt; - p_total: 5/20 violacoes (ex.: valor=0,1 (lim_max=0,05 delta=+0,05))</span></span>
<span><span class="co">#&gt; - ph: 1/20 violacoes (ex.: valor=5,9 (lim_min=6 lim_max=9 delta=-0,13))</span></span>
<span><span class="co">#&gt; - turbidez: 2/20 violacoes (ex.: valor=141 (lim_max=100 delta=+41))</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="generating-plots">Generating plots<a class="anchor" aria-label="anchor" href="#generating-plots"></a>
</h2>
<div class="section level3">
<h3 id="iqa-visualization">IQA visualization<a class="anchor" aria-label="anchor" href="#iqa-visualization"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bar plot of IQA by point</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_iqa.html">plot_iqa</a></span><span class="op">(</span><span class="va">df_iqa</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<p><img src="tikatuwq-workflow_files/figure-html/plot-iqa-1.png" alt="Figure generated by tikatuwq package" width="672"></p>
</div>
<div class="section level3">
<h3 id="time-series">Time series<a class="anchor" aria-label="anchor" href="#time-series"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Time series of a parameter</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_series.html">plot_series</a></span><span class="op">(</span><span class="va">df_iqa</span>, <span class="st">"turbidez"</span>, facet <span class="op">=</span> <span class="st">"ponto"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="tikatuwq-workflow_files/figure-html/plot-series-1.png" alt="Figure generated by tikatuwq package" width="672"></p>
</div>
<div class="section level3">
<h3 id="box-plots">Box plots<a class="anchor" aria-label="anchor" href="#box-plots"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Box plots by point</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_box.html">plot_box</a></span><span class="op">(</span><span class="va">df_iqa</span>, <span class="st">"od"</span>, by <span class="op">=</span> <span class="st">"ponto"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre></div>
<p><img src="tikatuwq-workflow_files/figure-html/plot-box-1.png" alt="Figure generated by tikatuwq package" width="672"></p>
</div>
<div class="section level3">
<h3 id="heatmap">Heatmap<a class="anchor" aria-label="anchor" href="#heatmap"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reshape to long format</span></span>
<span><span class="va">df_long</span> <span class="op">&lt;-</span> <span class="va">df_iqa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">ponto</span>, <span class="va">turbidez</span>, <span class="va">od</span>, <span class="va">dbo</span>, <span class="va">ph</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">turbidez</span>, <span class="va">od</span>, <span class="va">dbo</span>, <span class="va">ph</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"parametro"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"valor"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Heatmap</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span><span class="va">df_long</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span></code></pre></div>
<p><img src="tikatuwq-workflow_files/figure-html/plot-heatmap-1.png" alt="Figure generated by tikatuwq package" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="generating-a-textual-analysis-and-report">Generating a textual analysis and report<a class="anchor" aria-label="anchor" href="#generating-a-textual-analysis-and-report"></a>
</h2>
<p>The <code><a href="../reference/generate_analysis.html">generate_analysis()</a></code> function produces human-readable
paragraphs summarizing water quality:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate analytical text</span></span>
<span><span class="va">analysis_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_analysis.html">generate_analysis</a></span><span class="op">(</span></span>
<span>  <span class="va">df_iqa</span>,</span>
<span>  classe_conama <span class="op">=</span> <span class="st">"2"</span>,</span>
<span>  incluir_tendencia <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># Set TRUE if you have temporal data</span></span>
<span>  contexto <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>river <span class="op">=</span> <span class="st">"Demo River"</span>, period <span class="op">=</span> <span class="st">"2025"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">analysis_text</span>, collapse <span class="op">=</span> <span class="st">"\n\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Assessing the Water Quality Index (IQA) for the Demo River river in 2025 we observed an average of 91.4, ranging from 85.4 to 95.7. The dominant class was excellent. The best-performing point was FBS-BRH-450 (IQA~92.1), whereas FBS-BRH-300 presented the lowest value (IQA~90.7).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regarding compliance with CONAMA 357/2005 (class 2), violations were recorded, with p_total as the most critical parameter and point FBS-BRH-300 concentrating the highest number of occurrences.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The spatial variation of IQA was approximately 10.4 points between extremes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; It is recommended to assess organic load/BOD and re-aeration in affected stretches; inspect bank erosion and soil management in the basin; prioritizing critical points.</span></span></code></pre></div>
<p>For a full HTML report:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate HTML report (requires rmarkdown)</span></span>
<span><span class="co"># report_path &lt;- render_report(</span></span>
<span><span class="co">#   df_iqa,</span></span>
<span><span class="co">#   meta = list(river = "Demo River", period = "2025"),</span></span>
<span><span class="co">#   output_dir = tempdir()</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Open in browser</span></span>
<span><span class="co"># browseURL(report_path)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary-and-next-steps">Summary and next steps<a class="anchor" aria-label="anchor" href="#summary-and-next-steps"></a>
</h2>
<p>This vignette demonstrated a complete workflow:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Read data</strong>: <code><a href="../reference/read_wq.html">read_wq()</a></code> with censored
value handling</li>
<li>
<strong>Validate</strong>: <code><a href="../reference/validate_wq.html">validate_wq()</a></code> to check
required columns</li>
<li>
<strong>Clean units</strong>: <code><a href="../reference/clean_units.html">clean_units()</a></code> for unit
conversion and validation</li>
<li>
<strong>Compute indices</strong>: <code><a href="../reference/iqa.html">iqa()</a></code> for water
quality index</li>
<li>
<strong>Check compliance</strong>: <code><a href="../reference/conama_check.html">conama_check()</a></code>,
<code><a href="../reference/conama_summary.html">conama_summary()</a></code>, <code><a href="../reference/conama_report.html">conama_report()</a></code>
</li>
<li>
<strong>Visualize</strong>: <code><a href="../reference/plot_iqa.html">plot_iqa()</a></code>,
<code><a href="../reference/plot_series.html">plot_series()</a></code>, <code><a href="../reference/plot_box.html">plot_box()</a></code>,
<code><a href="../reference/plot_heatmap.html">plot_heatmap()</a></code>
</li>
<li>
<strong>Report</strong>: <code><a href="../reference/generate_analysis.html">generate_analysis()</a></code> and
<code><a href="../reference/render_report.html">render_report()</a></code>
</li>
</ol>
<div class="section level3">
<h3 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h3>
<ul>
<li>Explore temporal trends with <code><a href="../reference/trend_param.html">trend_param()</a></code> and
<code><a href="../reference/plot_trend.html">plot_trend()</a></code>
</li>
<li>Use <code><a href="../reference/param_analysis.html">param_analysis()</a></code> functions for parameter-specific
analysis</li>
<li>Create interactive maps with <code><a href="../reference/plot_map.html">plot_map()</a></code> if coordinates
are available</li>
<li>Adapt the workflow to your own datasets</li>
</ul>
<p>For more details, see: - The methods vignette for index calculations
and trend analysis - Package documentation:
<code><a href="https://tikatuwq.github.io/tikatuwq/reference">help(package = "tikatuwq")</a></code> - Online documentation: <a href="https://tikatuwq.github.io/tikatuwq/" class="uri">https://tikatuwq.github.io/tikatuwq/</a></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vinicius Saraiva Santos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
